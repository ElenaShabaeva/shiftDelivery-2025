!function(){"use strict";document.addEventListener("DOMContentLoaded",(function(){!function(){const e=document.querySelector("#js-select-city1");fetch("https://shift-intensive.ru/api/delivery/points").then((e=>{if(!e.ok)throw new Error("Сетевая ошибка");return e.json()})).then((t=>{t.success?t.points.forEach((t=>{const n=document.createElement("option");n.value=JSON.stringify(t),n.textContent=t.name,e.appendChild(n)})):console.log("Ошибка при получении данных: ",t)})).catch((e=>console.error("Ошибка: ",e)))}(),function(){const e=document.querySelector("#js-select-city2");fetch("https://shift-intensive.ru/api/delivery/points").then((e=>{if(!e.ok)throw new Error("Сетевая ошибка");return e.json()})).then((t=>{t.success?t.points.forEach((t=>{const n=document.createElement("option");n.value=JSON.stringify(t),n.textContent=t.name,e.appendChild(n)})):console.log("Ошибка при получении данных: ",t)})).catch((e=>console.error("Ошибка: ",e)))}(),function(){const e=document.querySelector("#js-select-package");fetch("https://shift-intensive.ru/api/delivery/package/types").then((e=>{if(!e.ok)throw new Error("error");return e.json()})).then((t=>{t.success?t.packages.forEach((t=>{const n=document.createElement("option");n.className="field__option",n.value=JSON.stringify(t),n.textContent=`${t.name}, ${t.length}x${t.width}x${t.height}`,e.appendChild(n)})):console.log("Ошибка при получении данных: ",t)})).catch((e=>console.log("Ошибка: ",e)))}()}));const e=document.getElementById("js-select-city1"),t=document.getElementById("js-select-city2"),n=document.getElementById("js-select-package"),o=document.getElementById("js-page1-btn");function c(){const c=""!==e.value,s=""!==t.value,a=""!==n.value;c&&s&&a&&o.classList.remove("btn--disabled")}e.addEventListener("change",c),t.addEventListener("change",c),n.addEventListener("change",c);function s(e){const t=document.querySelector("#js-delivery-container");t.innerHTML="",e.options.forEach((e=>{const n=document.createElement("a");n.href="#",n.className="page-first__card",n.classList.add="next-btn";const o=document.createElement("div");o.className="page-first__card-icon";const c=document.createElement("img");"EXPRESS"===e.type?c.src="assets/images/delivery1.svg":"DEFAULT"===e.type&&(c.src="assets/images/delivery2.svg"),o.appendChild(c);const s=document.createElement("div");s.className="page-first__card-info";const a=document.createElement("p");a.textContent=e.name,a.classList.add("page-first__card-subtitle");const r=document.createElement("h3"),i=Math.round(e.price/100);r.textContent=`${i} ₽`,r.classList.add("page-first__card-cost");const d=document.createElement("p");d.textContent=function(e){let t;t=1===e?"рабочий день":"рабочих дня";return`${e} ${t}`}(e.days),d.classList.add("page-first__card-time"),s.appendChild(a),s.appendChild(r),s.appendChild(d),n.appendChild(o),n.appendChild(s),t.appendChild(n)}))}function a(e){document.querySelectorAll(".page-hidden").forEach((e=>{e.classList.remove("page-active")}));document.getElementById(e).classList.add("page-active"),history.pushState({pageId:e},"",`#${e}`)}function r(){a(location.hash.replace("#","")||"page1")}document.querySelector("#js-select-form").addEventListener("submit",(function(e){e.preventDefault();const t=document.querySelector("#js-select-city1").value,n=document.querySelector("#js-select-city2").value,o=document.querySelector("#js-select-package").value,c=JSON.parse(t),a=JSON.parse(n),r={package:JSON.parse(o),senderPoint:c,receiverPoint:a};console.log(JSON.stringify(r)),fetch("https://shift-intensive.ru/api/delivery/calc",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((e=>{if(!e.ok)throw new Error("Сетевая ошибка: "+e.statusText);return e.json()})).then((e=>{console.log("Данные успешно отправлены: ",e),localStorage.setItem("postdata",JSON.stringify(e)),s(e)})).catch((e=>console.log("Ошибка: ",e)))})),document.querySelectorAll(".next-btn").forEach((e=>{e.addEventListener("click",(function(){a(this.getAttribute("data-page"))}))})),document.getElementById("homeLink").addEventListener("click",(function(){console.log("удаление"),localStorage.removeItem("postdata"),console.log(storedData)})),window.addEventListener("popstate",r),document.addEventListener("DOMContentLoaded",r),document.addEventListener("DOMContentLoaded",(function(){console.log("local");const e=localStorage.getItem("postdata");if(console.log(e),e){s(JSON.parse(e))}}))}();